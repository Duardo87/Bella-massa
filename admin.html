<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Admin ‚Ä¢ Bella Massa</title>

<style>
body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial;
  background: #f5f5f5;
}

header {
  background: #b11212;
  color: #fff;
  padding: 16px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

header a {
  color: #fff;
  text-decoration: none;
  font-weight: bold;
}

.container {
  max-width: 760px;
  margin: auto;
  padding: 16px;
}

.card {
  background: #fff;
  border-radius: 14px;
  padding: 16px;
  margin-bottom: 16px;
  box-shadow: 0 6px 18px rgba(0,0,0,.1);
}

label {
  display: block;
  margin-top: 12px;
  font-size: 14px;
}

input, select {
  width: 100%;
  padding: 10px;
  border-radius: 8px;
  border: 1px solid #ddd;
  margin-top: 4px;
}

button {
  margin-top: 14px;
  padding: 12px;
  border-radius: 10px;
  border: none;
  font-weight: bold;
  cursor: pointer;
}

.btn { background: #25d366; color: #fff; }
.btn-red { background: #b11212; color: #fff; }
.btn-outline {
  background: #fff;
  border: 2px solid #b11212;
  color: #b11212;
}

.extra-item {
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  padding:10px;
  background:#f7f7f7;
  border-radius:10px;
  margin-bottom:8px;
}

.hidden { display: none; }
small { color:#666 }
</style>
</head>

<body>

<header>
  <strong>üîê Admin ‚Ä¢ Bella Massa</strong>
  <a href="index.html">Ver site</a>
</header>

<div class="container">

<!-- LOGIN -->
<div id="login" class="card">
  <h2>Login</h2>
  <input id="email" value="admin@bellamassa.com">
  <input id="pass" type="password" value="123456">
  <button class="btn" onclick="login()">Entrar</button>
</div>

<!-- ADMIN -->
<div id="admin" class="hidden">

<!-- DADOS -->
<div class="card">
  <h2>üè™ Dados da Loja</h2>
  <input id="storeName" placeholder="Nome da pizzaria">
  <input id="storePhone" placeholder="WhatsApp">
  <button class="btn-red" onclick="saveStore()">Salvar</button>
</div>

<!-- CATEGORIAS -->
<div class="card">
  <h2>üóÇ Categorias</h2>
  <input id="catName" placeholder="Nova categoria">
  <button class="btn-outline" onclick="addCategory()">Adicionar</button>
  <div id="catList"></div>
</div>

<!-- PRODUTOS -->
<div class="card">
  <h2>üçï Produtos</h2>

  <input id="prodName" placeholder="Nome do produto">
  <input id="prodDesc" placeholder="Descri√ß√£o">
  <input id="prodPrice" placeholder="Pre√ßo">
  <select id="prodCat"></select>
  <input type="file" id="prodImage" accept="image/*">

  <label>
    <input type="checkbox" id="prodBest"> ‚≠ê Mais pedido
  </label>

  <button class="btn" onclick="addProduct()">Adicionar produto</button>
  <div id="productList"></div>
</div>

<!-- üî• ADICIONAIS -->
<div class="card">
  <h2>‚ûï Adicionais</h2>

  <label>Nome do adicional</label>
  <input id="extraName" placeholder="Ex: Borda recheada">

  <label>Pre√ßo</label>
  <input id="extraPrice" type="number" step="0.01" placeholder="Ex: 5.00">

  <button class="btn-outline" onclick="addExtra()">Adicionar adicional</button>

  <div id="extraList" style="margin-top:14px"></div>
</div>

<!-- PROMO -->
<div class="card">
  <h2>üî• Promo√ß√£o do Dia</h2>
  <input id="promoDesc" placeholder="Descri√ß√£o">
  <input id="promoPrice" placeholder="Pre√ßo">
  <input type="file" id="promoImage" accept="image/*">
  <input id="promoTime" placeholder="Dura√ß√£o (min)">
  <button class="btn" onclick="savePromo()">Salvar promo√ß√£o</button>
</div>

<!-- BACKUP -->
<div class="card">
  <h2>üì¶ Backup</h2>
  <button class="btn-outline" onclick="exportJSON()">Exportar JSON</button>
  <input type="file" id="importFile" accept="application/json">
  <button class="btn-outline" onclick="importJSON()">Importar JSON</button>
</div>

<button class="btn-red" onclick="logout()">Sair</button>

</div>
</div>

<script>
const KEY="pizzaria-data";
const DB=()=>JSON.parse(localStorage.getItem(KEY)||"{}");
const SAVE=d=>localStorage.setItem(KEY,JSON.stringify(d));

function login(){
  loginDiv.classList.add("hidden");
  admin.classList.remove("hidden");
  load();
}

function logout(){location.reload()}

function load(){
  const d=DB();
  storeName.value=d.store?.name||"";
  storePhone.value=d.store?.phone||"";
  renderCategories();
  renderProducts();
  renderExtras();
}

function saveStore(){
  const d=DB();
  d.store={name:storeName.value,phone:storePhone.value};
  SAVE(d);alert("Dados salvos");
}

function addCategory(){
  const d=DB();
  d.categories=d.categories||[];
  d.categories.push(catName.value);
  SAVE(d);catName.value="";
  renderCategories();
}

function renderCategories(){
  const d=DB();
  catList.innerHTML="";
  prodCat.innerHTML="";
  (d.categories||[]).forEach(c=>{
    catList.innerHTML+=`<p>${c}</p>`;
    prodCat.innerHTML+=`<option>${c}</option>`;
  });
}

function addProduct(){
  const d=DB();
  d.products=d.products||[];
  const r=new FileReader();
  r.onload=()=>{
    d.products.push({
      id:Date.now(),
      name:prodName.value,
      desc:prodDesc.value,
      price:parseFloat(prodPrice.value),
      category:prodCat.value,
      image:r.result,
      best:prodBest.checked
    });
    SAVE(d);
    renderProducts();
  };
  r.readAsDataURL(prodImage.files[0]);
}

function renderProducts(){
  const d=DB();
  productList.innerHTML="";
  (d.products||[]).forEach(p=>{
    productList.innerHTML+=`<p>${p.name} - R$ ${p.price}</p>`;
  });
}

/* ========= ADICIONAIS ========= */
function renderExtras(){
  const d=DB();
  d.extras=d.extras||[];
  extraList.innerHTML="";

  d.extras.forEach(e=>{
    extraList.innerHTML+=`
      <div class="extra-item">
        <div>
          <strong>${e.name}</strong><br>
          <small>R$ ${e.price.toFixed(2)}</small>
        </div>
        <label>
          <input type="checkbox" ${e.active!==false?"checked":""}
          onchange="toggleExtra(${e.id},this.checked)">
          Ativo
        </label>
        <button onclick="removeExtra(${e.id})"
          style="background:#b11212;color:#fff;border:none;
          padding:6px 10px;border-radius:8px">‚úï</button>
      </div>
    `;
  });
}

function addExtra(){
  const d=DB();
  d.extras=d.extras||[];
  d.extras.push({
    id:Date.now(),
    name:extraName.value,
    price:parseFloat(extraPrice.value),
    active:true
  });
  SAVE(d);
  extraName.value="";extraPrice.value="";
  renderExtras();
}

function toggleExtra(id,status){
  const d=DB();
  const e=d.extras.find(x=>x.id===id);
  if(e){e.active=status;SAVE(d);}
}

function removeExtra(id){
  if(!confirm("Remover adicional?"))return;
  const d=DB();
  d.extras=d.extras.filter(e=>e.id!==id);
  SAVE(d);
  renderExtras();
}

/* ========= PROMO ========= */
function savePromo(){
  const d=DB();
  const r=new FileReader();
  r.onload=()=>{
    d.promo={
      active:true,
      description:promoDesc.value,
      price:parseFloat(promoPrice.value),
      image:r.result,
      minutes:parseInt(promoTime.value),
      start:Date.now()
    };
    SAVE(d);alert("Promo salva");
  };
  r.readAsDataURL(promoImage.files[0]);
}

/* ========= BACKUP ========= */
function exportJSON(){
  const b=new Blob([JSON.stringify(DB(),null,2)],{type:"application/json"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(b);
  a.download="backup.json";
  a.click();
}

function importJSON(){
  const f=importFile.files[0];
  const r=new FileReader();
  r.onload=()=>{localStorage.setItem(KEY,r.result);location.reload()};
  r.readAsText(f);
}

const loginDiv=document.getElementById("login");
const admin=document.getElementById("admin");
</script>

</body>
</html>